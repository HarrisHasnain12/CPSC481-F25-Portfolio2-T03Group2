<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Expo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="home_page.css" />
</head>

<body>
  <div class="phone">

    <!-- HEADER -->
    <header class="home-header detail-header">
      <div class="expo-logo">
        <span style="font-size: 0.9em;">My Schedule</span>
      </div>

      <div class="search">üîç</div>
    </header>

    <!-- DATE ROW -->
    <div class="date-row">
      <button class="date-btn active">
        <span class="date-top">Apr 23</span>
        <span class="date-bottom">THU</span>
      </button>

      <button class="date-btn">
        <span class="date-top">Apr 24</span>
        <span class="date-bottom">FRI</span>
      </button>

      <button class="date-btn">
        <span class="date-top">Apr 25</span>
        <span class="date-bottom">SAT</span>
      </button>

      <button class="date-btn">
        <span class="date-top">Apr 26</span>
        <span class="date-bottom">SUN</span>
      </button>
    </div>

    <!-- BODY -->
    <main class="home-body schedule-body">
      <div id="eventList"></div>
    </main>

    <!-- NAV BAR -->
    <nav class="tab-bar">
      <a class="tab-item" href="home_page.html">
        <div class="tab-icon">ñ†ø</div>
        <div class="tab-label">Home</div>
      </a>
      <a class="tab-item" href="browse_events.html">
        <div class="tab-icon">‚òÜ</div>
        <div class="tab-label">Events</div>
      </a>
      <a class="tab-item" href="convention_map.html">
        <div class="tab-icon">‚û¢</div>
        <div class="tab-label">Navigation</div>
      </a>
      <a class="tab-item active" href="my_expo.html">
        <div class="tab-icon" style="padding-top: 3px;">‚ò∫Ô∏é</div>
        <div class="tab-label">My Expo</div>
      </a>
      <a class="tab-item" href="more.html">
        <div class="tab-icon">‚ò∞</div>
        <div class="tab-label">More</div>
      </a>
    </nav>
  </div>

  <!-- JS AT THE BOTTOM SO DOM IS LOADED -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const dateButtons = document.querySelectorAll('.date-btn');
      const eventList   = document.getElementById('eventList');

      // Map "Apr 23" etc. to full JSON date
      const dateMap = {
        "Apr 23": "April 23rd, 2026",
        "Apr 24": "April 24th, 2026",
        "Apr 25": "April 25th, 2026",
        "Apr 26": "April 26th, 2026"
      };

      let allEvents = [];
      fetch('panel.json')
        .then(response => response.json())
        .then(data => {
          allEvents = data.events.filter(e => e.added_to_my_expo);

          renderEventsForDate("April 23rd, 2026");
        })
        .catch(err => {
          console.error('Error loading events:', err);
          if (eventList) {
            eventList.innerHTML = '<p style="text-align:center; margin-top:20px;">Could not load events.</p>';
          }
        });

      function renderEventsForDate(dateString) {
        if (!eventList) return;

        eventList.innerHTML = '';

        const eventsForDate = allEvents.filter(e => e.date === dateString);

        if (eventsForDate.length === 0) {
          eventList.innerHTML =
            '<p style="text-align:center; margin-top:20px;">No events in your schedule for this day.</p>';
          return;
        }

        eventsForDate.forEach(ev => {
          const card = document.createElement('a');
          card.href = ev.event_detail_page || '#';
          card.className = 'event-card';

          card.innerHTML = `
            <div class="event-icon">‚≠ê</div>
            <div class="event-info">
              <div class="event-title">${ev.name}</div>
              <div class="event-time">${ev.start_time} ‚Äì ${ev.end_time}</div>
              <div class="event-location">Panel ${ev.panel} ‚Ä¢ ${ev.property}</div>
            </div>
            <div class="event-check">üìÖ</div>
          `;

          eventList.appendChild(card);
        });
      }

      // Date button click logic
      dateButtons.forEach(button => {
        button.addEventListener('click', () => {
          dateButtons.forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');

          const shortLabel = button.querySelector('.date-top').textContent.trim();
          const fullDate   = dateMap[shortLabel];

          if (fullDate) {
            renderEventsForDate(fullDate);
          }
        });
      });
    });
  </script>
</body>
</html>
